# Рефакторинг баз данных и приложений  
## Сценарий 2: Рефакторинг существующего программного проекта

### Студент
- **Мальцева Юлия Игоревна**

### Вариант №12106: Федеральная налоговая служба России - http://www.nalog.ru

### Описание проекта

Проект представляет собой веб-приложение, разработанное на базе **Spring Boot**, которое позволяет пользователям оплачивать налоги и госпошлины, а модераторам подтверждать платежи. Приложение поддерживает следующие функции:
- Управление платежей через REST API
- Разграничение доступа к бизнес-операциям
- Асинхронная обработка задач и выполнение периодических операций

### Стек технологий

- **Spring Boot** — основной фреймворк
- **PostgreSQL** — СУБД для хранения данных
- **Spring JTA** — для управления транзакциями
- **Spring Security** — аутентификация и авторизация
- **Apache Kafka** — очередь сообщений для асинхронной обработки
- **планировщик задач Spring (@Scheduled)** — планирование и выполнение периодических задач

### Функциональные требования

#### 1. Добавление и подтверждение рецепта

- Пользователи могут добавлять рецепты через REST API.
- Модераторы могут подтверждать рецепты перед их публикацией.

#### 2. REST API

Для работы с рецептами разработаны следующие публичные API:

- **POST /payments** — добавление нового платежа.
- **GET /payments** — получение списка всех платежей.
- **POST /admin/reviewPayment/{paymentId}** — подтверждение платежа (доступно только для модераторов).

#### 3. Управление транзакциями

Управление транзакциями реализовано с использованием **Spring JTA**. Программное управление транзакциями применяется в критичных для целостности данных бизнес-операциях.

#### 4. Разграничение доступа

Используя **Spring Security**, реализовано разграничение доступа:
- **HTTP Basic** аутентификация.
- Информация о пользователях и ролях хранится в **PostgreSQL**.
- Разделение прав доступа для обычных пользователей и модераторов.

#### 5. Асинхронная обработка

Асинхронная обработка реализована через **Apache Kafka + ZooKeeper**:

#### 6. Распределённая обработка

Сообщения Apache Kafka обрабатываются на двух экземплярах приложения, что обеспечивает отказоустойчивость и масштабируемость.

#### 7. Периодические задачи

Для выполнения периодических задач, таких как рассылка уведомлений, используется **@Scheduled**.
